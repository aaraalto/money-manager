{% extends "templates/layouts/base.html" %}
{% from "templates/components/atoms.html" import button, icon %}
{% from "templates/components/molecules.html" import card, stat, kpi_box, alert, dashboard_header with context %}

{% block title %}Radiant - Stability{% endblock %}

{% block extra_js %}
<script type="module" src="/static/js/modules/main.js"></script>
{% endblock %}

{% block content %}
    {{ dashboard_header("Level 2: Stability", "badge badge-success", "", "", "", "Review Budget", "list") }}

    <div id="loading">Checking defenses...</div>

    <div id="dashboard" class="hidden">
        <!-- Level 2 Focus: Emergency Fund & Security -->
        <div class="dashboard-overview">
             {% call card("Safety Net", "shield") %}
                <div class="stat">
                    <div class="stat-label">Emergency Fund</div>
                    <div class="stat-value text-success" id="nw-liquid">--</div>
                    <div class="stat-change">
                        <span id="runway-months">--</span> months runway
                    </div>
                </div>
                <div class="separator"></div>
                <div class="progress" style="margin-top: 1rem;">
                    <div class="progress-bar" style="width: 60%;"></div>
                </div>
                <p class="text-secondary" style="font-size: 0.85rem; margin-top: 0.5rem;">Goal: 6 Months Expenses</p>
            {% endcall %}

            {% call card("Net Worth Growth", "trending-up") %}
                 <div class="growth-container">
                     <div class="growth-main">
                         <div class="label-subtle">Total Net Worth</div>
                         <div class="value-hero" id="nw-total">--</div>
                     </div>
                     <div class="growth-details">
                         <div class="detail-item">
                             <div class="detail-label">Monthly Growth</div>
                             <div class="detail-value text-success" id="nw-monthly-growth">--</div>
                         </div>
                         <div class="detail-divider"></div>
                         <div class="detail-item">
                             <div class="detail-label">Savings Rate</div>
                             <div class="detail-value" id="savings-rate">--</div>
                         </div>
                     </div>
                 </div>
            {% endcall %}
        </div>

        <div class="grid">
            <!-- Begin showing investment projection lightly -->
            {% call card("Wealth Trajectory", "activity") %}
                <div class="chart-container" id="chart-projection"></div>
                <div class="reasoning" id="proj-context"></div>
            {% endcall %}
        </div>
    </div>
{% endblock %}
