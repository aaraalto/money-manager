{% extends "templates/layouts/base.html" %}
{% from "templates/components/atoms.html" import button, icon %}
{% from "templates/components/molecules.html" import card, stat, kpi_box, alert, dashboard_header with context %}

{% block title %}Radiant - Overview{% endblock %}

{% block extra_js %}
<script type="module" src="/static/js/modules/main.js"></script>
{% endblock %}

{% block content %}
    {{ dashboard_header("Level 1: Clarity", "badge badge-info", "") }}

    <div id="loading">Analyzing cash flow...</div>

    <div id="dashboard" class="hidden">
        <!-- Level 0 Focus: Cash Flow & Burn -->
        <div class="dashboard-overview">
            <!-- 1. Daily Safe-to-Spend (Primary Focus) -->
            {% call card("Daily Capacity", "activity") %}
                <div class="daily-spend-container">
                    <div class="spend-header">
                        <span class="label-mono">Daily Allowance</span>
                    <div class="spend-value-wrapper">
                        <span id="daily-allowance-value" class="spend-value">--</span>
                    </div>
                    </div>
                    
                    <div class="spend-context">
                        <div class="context-line"></div>
                        <p class="context-text">Guilt-free capital. <br>Remaining after all obligations.</p>
                        <div class="context-line"></div>
                    </div>

                    <div class="spend-metrics">
                        <div class="metric-item">
                            <span class="metric-label">Monthly Cap</span>
                            <span class="metric-value" id="monthly-allowance">--</span>
                        </div>
                        <div class="metric-divider"></div>
                        <div class="metric-item">
                            <span class="metric-label">Income Share</span>
                            <span class="metric-value" id="allowance-percentage">--</span>
                        </div>
                    </div>
                </div>
            {% endcall %}

            <!-- 2. Expense Breakdown -->
            {% call card("Expense Composition", "flame") %}
                 <div class="expense-composition-wrapper" style="display: flex; flex-direction: column; align-items: center; height: 100%;">
                    <div class="chart-container" id="chart-spending" style="width: 100%; height: 400px;"></div>
                 </div>
            {% endcall %}
        </div>

        <!-- Only show essentials -->
        <div class="grid">
             <!-- Projection -->
        </div>
    </div>
{% endblock %}
